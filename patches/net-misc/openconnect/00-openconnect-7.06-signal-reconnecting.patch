diff -Naur openconnect-7.06/cstp.c openconnect-7.06-new/cstp.c
--- openconnect-7.06/cstp.c	2016-01-08 12:29:19.680003287 -0500
+++ openconnect-7.06-new/cstp.c	2016-01-08 12:30:02.500003307 -0500
@@ -672,6 +672,7 @@
 		deflateEnd(&vpninfo->deflate_strm);
 	}
 
+  script_signal_reconnecting(vpninfo);
 	return ssl_reconnect(vpninfo);
 }
 
diff -Naur openconnect-7.06/openconnect-internal.h openconnect-7.06-new/openconnect-internal.h
--- openconnect-7.06/openconnect-internal.h	2015-03-17 09:29:49.000000000 -0400
+++ openconnect-7.06-new/openconnect-internal.h	2016-01-08 12:32:48.420003386 -0500
@@ -755,6 +755,7 @@
 int script_config_tun(struct openconnect_info *vpninfo, const char *reason);
 int apply_script_env(struct oc_vpn_option *envs);
 void free_split_routes(struct openconnect_info *vpninfo);
+void script_signal_reconnecting(struct openconnect_info *vpninfo);
 
 /* tun.c / tun-win32.c */
 void os_shutdown_tun(struct openconnect_info *vpninfo);
diff -Naur openconnect-7.06/script.c openconnect-7.06-new/script.c
--- openconnect-7.06/script.c	2015-02-27 05:56:03.000000000 -0500
+++ openconnect-7.06-new/script.c	2016-01-08 12:34:28.340003434 -0500
@@ -570,3 +570,10 @@
 	return 0;
 }
 #endif
+
+void script_signal_reconnecting(struct openconnect_info *vpninfo) {
+  if (vpninfo->vpnc_script && !vpninfo->script_tun) {
+    setenv("reason", "reconnecting", 1);
+    script_config_tun(vpninfo);
+  }
+}
